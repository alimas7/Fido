name: Frak Windoze
on: workflow_dispatch

jobs:
    build:
      name: Get Frakking Windoze
      runs-on: windows-latest
      steps:
###        - name: S0a
###          run: dir/s/b/od *.ps1 & dir C:\ & dir D:\ & pwd
###          shell: cmd /c {0}
        - uses: actions/checkout@master
          with:
            path: .\Fido
###        - name: S0b
###          run: dir/s/b/od *.ps1 & pwd
###          shell: cmd /c {0}
        - uses: actions/checkout@master
          with:
            path: .\t11b
            repository: alimas7/tiny11builder
###            ref: refs/heads/release
        - name: S1
          run: .\Fido\Fido.ps1 -Win 11 -Ed Pro -Lang English ### -GetUrl
          shell: powershell
###        - name: S2
###          run: dir/s/b/od & pwd
###          shell: cmd /c {0}
        - name: S3
          run: .\t11b\tiny11Coremaker.ps1
          shell: powershell
        - name: S4a
          if: always()
          run: dir /os D:\a\Fido\Fido\t11b\ > 1.t11b.out & pwd
          shell: cmd /c {0}
        - name: S4b
          if: always()
          run: dir/s/b D:\ > 3.d.out & pwd
          shell: cmd /c {0}
        - name: S4c
          if: always()
          run: dir/s/b C:\ > 2.c.out & pwd
          shell: cmd /c {0}
###        - name: S5
###          if: always()
###          run: dir/s/b E:\ & pwd
###          shell: cmd /c {0}
        - name: S6
          uses: actions/upload-artifact@v4
          with:
            name: t11b-1
            path: |
              D:\a\Fido\Fido\t11b\tiny11.iso
              D:\a\Fido\Fido\t11b\tiny11.log
              1.t11b.out
              2.c.out
              3.d.out
            compression-level: 9
        - name: S7
          uses: actions/upload-artifact@v4
          with:
            name: t11b-2
            path: |
              D:\
              !D:/*.tmp
              !D:\a\Fido\Fido\Win11_23H2_English_x64v2.iso
              !D:\a\Fido\Fido\t11b\tiny11.iso
              !D:\a\Fido\Fido\t11b\tiny11.log
            compression-level: 9
